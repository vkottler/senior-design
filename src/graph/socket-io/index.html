<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Socket IO Telemetry</title>
        <script src="/socket.io/socket.io.js"></script>
        <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
        <script src="http://canvasjs.com/assets/script/canvasjs.min.js"></script>
    </head>
    <body>
      	<h1 align="center">Quadcopter Telemetry Viewing</h1>
      <div id="chartContainerX" style="height: 360px; width: 100%;"></div>
      <h>"Acceleration (X): " <span id="accel_x"></span></h>
      <div id="chartContainerY" style="height: 360px; width: 100%;"></div>
      <h>"Acceleration (Y): " <span id="accel_y"></span></h>
      <div id="chartContainerZ" style="height: 360px; width: 100%;"></div>
      <h>"Acceleration (Z): " <span id="accel_z"></span></h>

      <script>
      var data_accelx = [];
      var data_accely = []; 
      var data_accelz = []; 
   
      var chart_x = new CanvasJS.Chart("chartContainerX", {
        zoomEnabled: true,
        title :{
          text: "Accelerometer (X) v. Time"
        },
        axisY: {	
          title: "Accel (X) (m/s^2)",
          includeZero: true
        },
        axisX: {
          title:"Time (s)",
          includeZero: false
        },         
        data: [
          //accel x 
        {	
          type: "line",
          dataPoints: data_accelx,
          showInLegend: true,
          legendText: "Accel X", 
          color: "blue"
        }
        ]
      });
     
      var chart_y = new CanvasJS.Chart("chartContainerY", {
        zoomEnabled: true,
        title :{
          text: "Accelerometer (Y) v. Time"
        },
        axisY: {	
          title: "Accel (Y) (m/s^2)",
          includeZero: true
        },
        axisX: {
          title:"Time (s)",
          includeZero: false
        },         
        data: [
          //accel y 
        {	
          type: "line",
          dataPoints: data_accely,
          showInLegend: true,
          legendText: "Accel Y", 
          color: "red"
        }
        ]
      });
      
      var chart_z = new CanvasJS.Chart("chartContainerZ", {
        zoomEnabled: true,
        title :{
          text: "Accelerometer (Z) v. Time"
        },
        axisY: {	
          title: "Accel (Z) (m/s^2)",
          includeZero: true
        },
        axisX: {
          title:"Time (s)",
          includeZero: false
        },         
        data: [
          //accel z 
        {	
          type: "line",
          dataPoints: data_accelz,
          showInLegend: true,
          legendText: "Accel Z", 
          color: "green"
        }
        ]
      });

      $(function () {
          var socket = io();
          socket.on('dataLine', (data_set) =>
          {
            var incoming_x = data_set[0].x
            var incoming_y = data_set[0].y
            var incoming_z = data_set[0].z
            
            document.getElementById("accel_x").innerHTML = incoming_x;
            document.getElementById("accel_y").innerHTML = incoming_y;
            document.getElementById("accel_z").innerHTML = incoming_z;


            console.log("incoming data set -- ")
            console.log("incoming telem x: ",incoming_x);
            console.log("incoming telem y: ",incoming_y);
            console.log("incoming telem z: ",incoming_z);
            console.log("-------------------- ")

              data_accelx.push({
                x: incoming_x 
              });
              data_accely.push({
                x: incoming_y
              });
              data_accelz.push({
                x: incoming_z
              });
            
            chart_x.render();
            chart_y.render();
            chart_z.render();
          });
        });

        </script> 
    </body>
</html>

